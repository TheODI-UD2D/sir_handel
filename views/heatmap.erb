<script src="/public/javascripts/heatmap.js"></script>
<script src="/public/javascripts/colouriser.js"></script>

<%= erb :'includes/date_form', locals: { url: '/heatmap', date: @date } %>

<% if @period == true %>
  <script>
  $(function () {
    initButtons('<%= @date %>');

    $('#next').click(function() {
      directionButton($(this).attr('data-date'), '<%= @from %>', '<%= @to %>');
    })

    $('#previous').click(function() {
      directionButton($(this).attr('data-date'), '<%= @from %>', '<%= @to %>');
    })
  });
  </script>
  <p>
    <a href='#' class='btn btn-primary' id='previous'>Previous</a>
    <a href='#' class='btn btn-primary' id='next'>Next</a>
  </p>
<% end %>

<% stations = YAML.load_file File.join('config', 'stations.yml') %>

<p id="loading"><i class="fa fa-spinner fa-spin"></i></p>

<div id="heatmap" class="col-md-10 col-md-offset-2">

  <div id="stations" class="hidden">
    <div class='col-md-6'>
      <h2>Northbound</h2>
      <%= erb :"includes/_stations", locals: { stations: Hash[stations.to_a.reverse], direction: :northbound } %>
    </div>

    <div class='col-md-6'>
      <h2>Southbound</h2>
      <%= erb :"includes/_stations", locals: { stations: stations, direction: :southbound } %>
    </div>
  </div>
</div>

<script>
$(function () {
  loadHeatmap(document.URL);
});
</script>
